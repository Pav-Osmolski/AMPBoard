(()=>{"use strict";function e(){const e=document.querySelector(".clock");if(e){const t=new Date;e.textContent=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}}const t=new WeakSet;function n(e,n={}){const o=document.querySelector(e);if(!o)return;if(t.has(o))return;t.add(o);const a=n.items||"li",r=n.handle||null,l=n.interactiveSelector||"input, select, textarea, button, a, [contenteditable], .no-drag",s=n.allowInsideHandle||"[data-drag-allow]",i=n.allowHandleInteractive??!0;let c=null,d=!1;o.addEventListener("pointerdown",e=>{const t=e.target.closest(a);if(!t||!o.contains(t))return;const n=!r||!!e.target.closest(r);if(r&&!n)return;if(!!e.target.closest(l)){if(!(i&&n&&e.target.closest(s)))return}t.draggable=!0},{capture:!0}),o.addEventListener("dragstart",e=>{const t=e.target.closest(a);if(t&&o.contains(t)){c=t,d=!0,e.dataTransfer.effectAllowed="move";try{e.dataTransfer.setData("text/plain","")}catch(e){}t.classList.add("dragElem")}}),o.addEventListener("dragenter",e=>{const t=e.target.closest(a);t&&o.contains(t)&&t.classList.add("over")}),o.addEventListener("dragover",e=>{c&&e.preventDefault()}),o.addEventListener("dragleave",e=>{const t=e.target.closest(a);t&&o.contains(t)&&t.classList.remove("over")}),o.addEventListener("drop",e=>{e.preventDefault();const t=e.target.closest(a);if(!t||!c||t===c)return;const n=Array.from(o.querySelectorAll(`:scope > ${a}`)),r=n.indexOf(c),l=n.indexOf(t);r>-1&&l>-1&&(r<l?t.after(c):t.before(c),o.dispatchEvent(new CustomEvent("sorted",{bubbles:!0}))),t.classList.remove("over")}),o.addEventListener("dragend",e=>{const t=e.target.closest(a);t&&o.contains(t)&&(t.classList.remove("dragElem"),t.draggable=!1),Array.from(o.querySelectorAll(a)).forEach(e=>e.classList.remove("over")),c=null,d=!1}),o.addEventListener("click",e=>{d&&r&&e.target.closest(r)&&e.preventDefault()},!0)}const o=["max-xs","max-sm","max-md","max-lg"];function a(e){return e.dataset.widthKey||"width_element"}function r(e,t){if(!e)return;const n=a(e);localStorage.setItem(n,t),e.classList.forEach(t=>{t.startsWith("max-")&&e.classList.remove(t)}),"auto"!==t?e.classList.add(t):e.style.maxWidth=""}function l(e,t,n=o){if(!e)return;const l=a(e),s=localStorage.getItem(l)||"auto";let i,c=n.indexOf(s);if(-1===c)i="prev"===t?n.length-1:0;else if("next"===t)i=(c+1)%n.length;else{if("prev"!==t)return;i=(c-1+n.length)%n.length}r(e,n[i])}function s({sectionId:e,toggleButtonId:t,logElementId:n,endpoint:o}){document.addEventListener("DOMContentLoaded",()=>{const a=document.body;if(!document.getElementById(e))return;const r=document.getElementById(t),l=document.getElementById(n);function s(e){const t=""===e.trim();l.innerHTML=t?'<code class="muted">No errors logged. You\'re doing great. üéâ</code>':`<code>${e}</code>`}function i(){fetch(`${window.BASE_URL}${o}`,{cache:"no-store"}).then(e=>e.ok?e.text():Promise.reject()).then(s)}r&&l&&(r.addEventListener("click",function(){const e=l.classList.contains("visible");l.classList.toggle("visible",!e),this.setAttribute("aria-expanded",!e)}),"true"===a.getAttribute("data-ajax-error-log-enabled")&&fetch(`${window.BASE_URL}${o}`,{cache:"no-store"}).then(e=>e.ok?e.text():Promise.reject()).then(e=>{s(e),setInterval(i,3e3)}).catch(()=>{}))})}function i(){const e=document.getElementById("export-group"),t=document.getElementById("export-folder"),n=document.getElementById("uploads-mode-row"),o=document.getElementById("export-files-form"),a=document.getElementById("export-files-status"),r=document.getElementById("export-db-form"),l=document.getElementById("export-db"),s=document.getElementById("export-db-status");if(!(e&&t&&o&&r))return;let i=[];function c(){return fetch(`${window.BASE_URL}utils/export_files.php?action=token`,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{e.ok&&e.token&&document.querySelectorAll('input[name="csrf"]').forEach(t=>{t.value=e.token})}).catch(()=>{})}function d(){const e=document.querySelector('input[name="archiveEngine"]:checked');return e?e.value:"php"}c(),fetch(`${window.BASE_URL}utils/export_files.php?action=scan`,{credentials:"same-origin"}).then(e=>e.json()).then(o=>{if(!o.ok)throw new Error(o.error||"Failed to scan folders");if(i=o.groups||[],!i.length)return e.innerHTML='<option value="">No folders defined</option>',e.disabled=!0,t.innerHTML='<option value="">No subfolders</option>',t.disabled=!0,a&&(a.innerHTML="No folders defined. Add entries to <code>config/folders.json</code> to enable file exports."),void(n&&(n.style.display="none"));!function(e,t){e.innerHTML="",t.forEach(t=>{const n=document.createElement("option");n.value=String(t.index),n.textContent=t.title,e.appendChild(n)})}(e,i),e.options.length&&e.dispatchEvent(new Event("change"))}).catch(n=>{console.error(n),e.innerHTML='<option value="">Error loading groups</option>',e.disabled=!0,t.innerHTML='<option value="">‚Äî</option>',t.disabled=!0}),fetch(`${window.BASE_URL}utils/export_files.php?action=dbs`,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"Failed to list databases");var t,n;t=l,n=e.databases||[],t.innerHTML="",n.length?n.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}):t.innerHTML='<option value="">No databases found</option>'}).catch(e=>{console.error(e),l.innerHTML='<option value="">Error loading databases</option>'}),e.addEventListener("change",()=>{const o=parseInt(e.value,10),a=Number.isNaN(o)?null:i[o];t.disabled=!0,t.innerHTML='<option value="">Select a group first‚Ä¶</option>',n&&(n.style.display="none");const r=document.querySelector('input[name="uploadsMode"][value="exclude"]');var l,s;(r&&(r.checked=!0),a)&&(l=t,s=a.subfolders,l.innerHTML="",s.length?s.forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,l.appendChild(t)}):l.innerHTML='<option value="">No subfolders found</option>',t.disabled=0===a.subfolders.length,a.subfolders.length>0&&(t.selectedIndex=0,t.dispatchEvent(new Event("change"))))}),t.addEventListener("change",()=>{const o=parseInt(e.value,10),a=Number.isNaN(o)?null:i[o];if(!a)return;const r=a.subfolders.find(e=>e.name===t.value),l=!!(r&&r.isWordPress&&r.hasUploads);n&&(n.style.display=l?"":"none");const s=document.querySelector('input[name="uploadsMode"][value="exclude"]');s&&(s.checked=!0)}),o.addEventListener("submit",e=>{e.preventDefault(),a.textContent="Preparing archive‚Ä¶";const t=new FormData(o);t.append("action","zip"),t.append("engine",d()),fetch(`${window.BASE_URL}utils/export_files.php`,{method:"POST",body:t,credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"Export failed");let t=`Done. <a href="${window.BASE_URL}${e.href}" download="${e.name}">${e.name}</a>`;return e.message&&(t+=`<br><small class="muted">${e.message}</small>`),a.innerHTML=t,window.location.href=`${window.BASE_URL}${e.href}`,c()}).catch(e=>(console.error(e),a.textContent="Error: "+e.message,c()))}),r.addEventListener("submit",e=>{e.preventDefault(),s.textContent="Dumping database‚Ä¶";const t=new FormData(r);t.append("action","dumpdb"),t.append("engine",d()),fetch(`${window.BASE_URL}utils/export_files.php`,{method:"POST",body:t,credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(!e.ok)throw new Error(e.error||"DB export failed");let t=`Done. <a href="${window.BASE_URL}${e.href}" download="${e.name}">${e.name}</a>`;return e.message&&(t+=`<br><small class="muted">${e.message}</small>`),s.innerHTML=t,window.location.href=`${window.BASE_URL}${e.href}`,c()}).catch(e=>(console.error(e),s.textContent="Error: "+e.message,c()))})}function c(e,t={}){const n=t.placeholder||"HTML Template";let o="",a=!1,r=!1;function l(){return e.textContent.replace(/\u200B/g,"").replace(/\u00A0/g," ")}function s(e){const t=window.getSelection();if(!t.rangeCount)return null;const n=t.getRangeAt(0),o=n.cloneRange();o.selectNodeContents(e),o.setEnd(n.endContainer,n.endOffset);const a=e.textContent.length;return Math.min(o.toString().length,a)}function i(e,t){const n=window.getSelection(),o=document.createRange();let a=0,r=null;const l=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;l.nextNode();){const e=l.currentNode,s=e.nodeValue.length;if(r=e,a+s>=t)return o.setStart(e,t-a),o.collapse(!0),n.removeAllRanges(),void n.addRange(o);a+=s}if(!r){const t=document.createTextNode("");e.appendChild(t),r=t}o.setStart(r,r.nodeValue.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o)}function c(){a=!1;const r=l();if(r===o)return;const c=s(e);let d=r;d.endsWith("\n")&&!d.endsWith("\n‚Äã")&&(d+="‚Äã"),e.innerHTML=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&lt;\/?[a-zA-Z][^&]*?&gt;/g,e=>{let t=e.slice(4,-4).trim(),n=!1,o=!1;t.startsWith("/")&&(n=!0,t=t.slice(1).trim()),t.endsWith("/")&&(o=!0,t=t.slice(0,-1).trim());const a=t.search(/\s/),r=(-1===a?t:t.slice(0,a)).toLowerCase();let l=-1===a?"":t.slice(a).trim();return l=l.replace(/([a-zA-Z_:][-a-zA-Z0-9_:.]*)\s*(=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+))?/g,(e,t,n)=>{if(!t)return e;if(!n)return`<span class="attr">${t}</span>`;const o=n.match(/^=\s*(?:"([^"]*)"|'([^']*)'|([^\s'">=]+))/);if(!o)return`<span class="attr">${t}</span>${n||""}`;const a=o[1]??o[2]??o[3]??"",r=o[1]?'"':o[2]?"'":"";return r?`<span class="attr">${t}</span>=<span class="value">${r}${a}${r}</span>`:`<span class="attr">${t}</span>=<span class="value">${a}</span>`}),`<span class="pun">&lt;${n?"/":""}</span><span class="tag">${r}</span>${l?` ${l}`:""}<span class="pun">${o?" /":""}&gt;</span>`}),e.hasAttribute("placeholder")||e.setAttribute("placeholder",n),r.length>0&&(!e.lastChild||e.lastChild.nodeType!==Node.TEXT_NODE)&&e.appendChild(document.createTextNode("")),null!=c&&i(e,c),o=r,t.onChange&&t.onChange(r)}function d(t){if("insertFromPaste"===t.inputType&&t.clipboardData){t.preventDefault();!function(t){const n=l(),a=s(e)??n.length,r=n.slice(0,a)+t+n.slice(a);e.textContent=r,i(e,a+t.length),o="",c()}(t.clipboardData.getData("text/plain").replace(/\r\n?/g,"\n"))}}function u(t){if("Escape"!==t.key)if("Tab"===t.key&&r)r=!1;else{if("Tab"===t.key){t.preventDefault();const n=l();let a=s(e),r=n;return t.shiftKey?"\t"===n.slice(a-1,a)?(r=n.slice(0,a-1)+n.slice(a),a-=1):"  "===n.slice(a-2,a)&&(r=n.slice(0,a-2)+n.slice(a),a-=2):(r=n.slice(0,a)+"\t"+n.slice(a),a+=1),e.textContent=r,i(e,a),o="",void c()}if("Enter"===t.key&&!t.shiftKey){const n=l();if(0===n.length)return;t.preventDefault();let a=s(e);const r="\n"+((n.slice(0,a).split(/\r?\n/).pop()||"").match(/^[\t ]+/)||[""])[0];let d=n.slice(0,a)+r+n.slice(a),u=a+r.length;d===n&&(d=n+r,u=n.length+r.length),e.textContent=d,e.focus(),i(e,u),o="",c()}}else r=!0}function p(n){return/^[\s\u200B]*$/.test(e.textContent)&&((n.inputType||"").startsWith("delete")||"deleteByCut"===n.inputType)?(e.innerHTML="",o="",void(t.onChange&&t.onChange(""))):"insertParagraph"===n.inputType||"insertFromPaste"===n.inputType||"insertFromDrop"===n.inputType||"historyUndo"===n.inputType||"historyRedo"===n.inputType?(o="",void c()):void(a||(a=!0,requestAnimationFrame(()=>{try{c()}finally{a=!1}})))}function m(){r=!1,c()}return e.setAttribute("contenteditable","true"),e.setAttribute("role","textbox"),e.setAttribute("aria-multiline","true"),e.setAttribute("aria-label",n),e.setAttribute("aria-describedby",t.describedBy||"editor-instructions"),e.setAttribute("placeholder",n),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("autocorrect","off"),e.addEventListener("beforeinput",d),e.addEventListener("keydown",u),e.addEventListener("input",p),e.addEventListener("blur",m),c(),{getValue:()=>l(),setValue(t){e.textContent=t||"",o="",c()},destroy(){e.removeEventListener("beforeinput",d),e.removeEventListener("keydown",u),e.removeEventListener("input",p),e.removeEventListener("blur",m)}}}function d(){const e=document.querySelector(".search-bar")?.value.toLowerCase()||"";document.querySelectorAll("#folders-view .columns li").forEach(t=>{const n=t.textContent.toLowerCase();t.style.display=n.includes(e)?"":"none"})}const u=["theme","columnOrder","accordion_","width_"];function p(e){const t=document.documentElement;t.className=t.className.split(/\s+/).filter(e=>e&&!e.endsWith("-theme")).join(" "),"default"!==e&&t.classList.add(`${e}-theme`);let n="dark";document.body.classList.contains("dark-mode")||(document.body.classList.remove("light-mode"),document.body.classList.add("dark-mode")),"undefined"!=typeof themeTypes&&"light"===themeTypes[e]&&(n="light",document.body.classList.contains("light-mode")||(document.body.classList.remove("dark-mode"),document.body.classList.add("light-mode")));let o=document.querySelector('meta[name="color-scheme" ]');o||(o=document.createElement("meta"),o.setAttribute("name","color-scheme"),document.head.appendChild(o)),o.getAttribute("content")!==n&&o.setAttribute("content",n)}function m(){document.querySelectorAll("[data-generate-cert]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.generateCert;confirm("Generate a new SSL certificate for "+t+"?")&&fetch(`${window.BASE_URL}utils/generate_cert.php?name=${encodeURIComponent(t)}`).then(e=>e.text()).then(e=>{if(alert(e),e.includes("successfully")){const e=document.getElementById("restart-apache");e&&e.click()}}).catch(()=>alert("Failed to run cert script."))})})}function h(){const e=document.getElementById("vhost-filter"),t=document.querySelectorAll("#vhosts-table tbody tr");e&&t.length&&e.addEventListener("change",()=>{const n=e.value;let o=0;t.forEach(e=>{const t=e.classList.contains("vhost-ssl"),a=e.classList.contains("cert-valid"),r=e.classList.contains("host-valid");let l=!0;"missing-cert"===n?l=!a:"missing-host"===n?l=!r:"ssl-only"===n?l=t:"non-ssl"===n&&(l=!t),e.style.display=l?"":"none",l&&o++});const a=document.getElementById("vhost-empty-msg");a&&(a.style.display=0===o?"":"none")})}function g(){document.addEventListener("click",e=>{if(e.target.matches(".open-folder")){const t=e.target.dataset.path.replace(/^"(.*)"$/,"$1");t&&fetch(`${window.BASE_URL}utils/open_folder.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})})}})}document.addEventListener("DOMContentLoaded",()=>{e(),setInterval(e,1e3)}),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".width-resizable").forEach(e=>{const t=a(e),n=localStorage.getItem(t);n&&o.includes(n)&&r(e,n)}),document.querySelectorAll(".width-controls").forEach(e=>{const t=e.dataset.widthFor;if(!t)return;const n=document.querySelector(`.width-resizable[data-width-key="${t}"]`);if(!n)return;const a=e.querySelector('[data-action="reset"]'),s=e.querySelector('[data-action="decrease"]'),i=e.querySelector('[data-action="increase"]');a&&a.addEventListener("click",()=>{r(n,"auto")}),s&&s.addEventListener("click",()=>{l(n,"prev",o)}),i&&i.addEventListener("click",()=>{l(n,"next",o)})});const e=document.querySelector(".columns");if(e){const t=JSON.parse(localStorage.getItem("columnOrder")||"[]");function s(){const t=Array.from(e.querySelectorAll(":scope > .column:not(.column-controls)")).map(e=>e.id).filter(Boolean);localStorage.setItem("columnOrder",JSON.stringify(t))}Array.isArray(t)&&t.length&&t.forEach(t=>{const n=document.getElementById(t);n&&n.classList.contains("column")&&!n.classList.contains("column-controls")&&e.appendChild(n)}),n(".columns",{items:".column:not(.column-controls)",handle:".drag-handle"}),e.addEventListener("sorted",s)}}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("dock-list"),t=document.getElementById("add-dock-item"),o=document.querySelector("#settings-view form");function a(t={}){const n=document.createElement("li");n.className="dock-item",n.innerHTML=`\n\t\t\t\t<input type="text" placeholder="Label" value="${t.label||""}">\n\t\t\t\t<input type="text" placeholder="URL" value="${t.url||""}">\n\t\t\t\t<input type="text" placeholder="Icon" value="${t.icon||""}">\n\t\t\t\t<input type="text" placeholder="Alt Text" value="${t.alt||""}">\n\t\t\t\t<button type="button" class="remove-dock-item">‚ùå</button>\n\t\t\t`,e.appendChild(n),n.querySelector(".remove-dock-item").addEventListener("click",()=>{n.remove(),r()}),Array.from(n.querySelectorAll("input")).forEach(e=>{e.addEventListener("input",r)})}function r(){const t=[];Array.from(e.children).forEach(e=>{const n=e.querySelectorAll("input");n.length<4||t.push({label:n[0].value.trim(),url:n[1].value.trim(),icon:n[2].value.trim(),alt:n[3].value.trim()})});const n=document.getElementById("dock_json_input");n&&(n.value=JSON.stringify(t,null,2))}e&&t&&o&&(fetch(`${window.BASE_URL}utils/read_config.php?file=dock`,{cache:"no-store"}).then(e=>e.json()).then(t=>{t.forEach(a),n("#dock-list"),e.addEventListener("sorted",r),r()}),t.addEventListener("click",()=>{a(),n("#dock-list"),r()}))}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("folders-config-list"),t=document.getElementById("add-folder-column"),o=document.getElementById("folders_json_input");if(!e||!t||!o)return;let a=[],r='<option value="">(none)</option>',l=!1,s=null;function i(e={}){return`\n\t\t\t\t<div class="special-case">\n\t\t\t\t\t<input type="text" class="sc-match" placeholder="Match Regex" value="${e.match||""}">\n\t\t\t\t\t<input type="text" class="sc-replace" placeholder="Replace Regex" value="${e.replace||""}">\n\t\t\t\t\t<button type="button" class="remove-special">‚úñ</button>\n\t\t\t\t</div>\n\t\t\t`}function c(e={}){const t=(n=e.specialCases,n&&"object"==typeof n&&!Array.isArray(n)?Object.entries(n).map(([e,t])=>({match:String(e??""),replace:String(t??"")})):[]).map(i).join("");var n;e.linkTemplate;const o=`uid-${Math.random().toString(36).slice(2)}`;return`\n\t\t\t\t<li class="folder-config-item">\n\t\t\t\t\t<input type="text" data-key="title"\n\t\t\t\t\t       placeholder="Title"\n\t\t\t\t\t       aria-label="Column title"\n\t\t\t\t\t       value="${e.title||""}">\n\n\t\t\t\t\t<input type="text" data-key="href"\n\t\t\t\t\t       placeholder="Href (optional)"\n\t\t\t\t\t       aria-label="Column href (optional)"\n\t\t\t\t\t       value="${e.href||""}">\n\n\t\t\t\t\t<input type="text" data-key="dir"\n\t\t\t\t\t       placeholder="Dir (relative to HTDOCS_PATH)"\n\t\t\t\t\t       aria-label="Directory relative to htdocs"\n\t\t\t\t\t       value="${e.dir||""}">\n\n\t\t\t\t\t<input type="text" data-key="excludeList"\n\t\t\t\t\t       placeholder="Exclude list (comma-separated)"\n\t\t\t\t\t       aria-label="Exclude list, comma separated"\n\t\t\t\t\t       value="${(e.excludeList||[]).join(",")}">\n\n\t\t\t\t\t<input type="text" data-key="match"\n\t\t\t\t\t       placeholder="Match Regex"\n\t\t\t\t\t       aria-label="Match regex"\n\t\t\t\t\t       value="${e.urlRules?.match??""}">\n\n\t\t\t\t\t<input type="text" data-key="replace"\n\t\t\t\t\t       placeholder="Replace Regex"\n\t\t\t\t\t       aria-label="Replace regex"\n\t\t\t\t\t       value="${e.urlRules?.replace??""}">\n\t\t\t\t\t<label>Link Template:\n\t\t\t\t\t\t<select class="link-template-select" name="linkTemplate">${r}</select>\n\t\t\t\t\t</label>\n\t\t\t\t\t<div class="uid-container grouped-labels" role="group" aria-labelledby="folder-behaviour-${o}">\n\t\t\t\t\t  <span id="folder-behaviour-${o}">Folder Behaviour:</span>\n\t\t\t\t\t  <label>\n\t\t\t\t\t    <input type="checkbox" class="disable-links"${e.disableLinks?" checked":""}>\n\t\t\t\t\t    Disable links\n\t\t\t\t\t  </label>\n\t\t\t\t\t  <label>\n\t\t\t\t\t    <input type="checkbox" class="require-vhost"${e.requireVhost?" checked":""}>\n\t\t\t\t\t    Valid vHost only\n\t\t\t\t\t  </label>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="uid-container special-cases-wrapper" aria-labelledby="special-cases-${o}">\n\t\t\t\t\t\t<span id="special-cases-${o}">Special Cases:</span>\n\t\t\t\t\t\t<div class="special-cases">${t}</div>\n\t\t\t\t\t\t<button type="button" class="add-special" aria-label="Add special case rule">‚ûï Add Rule</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button type="button" class="remove-folder-column" aria-label="Remove this folder column">‚ùå</button>\n\t\t\t\t</li>\n\t\t\t`}function d(t={}){const n=document.createElement("div");n.innerHTML=c(t);const o=n.firstElementChild;e.appendChild(o);const r=o.querySelector(".link-template-select");r&&(r.disabled=0===a.length,t.linkTemplate&&(r.value=t.linkTemplate)),u()}function u(){l=!0,s&&clearTimeout(s),s=setTimeout(p,120)}function p(){s=null,l&&(o.value=JSON.stringify(function(){const t=[];return e.querySelectorAll(".folder-config-item").forEach(e=>{const n=t=>e.querySelector(t),o=n('input[data-key="title"]')?.value.trim()||"",a=n('input[data-key="href"]')?.value.trim()||"",r=n('input[data-key="dir"]')?.value.trim()||"",l=n('input[data-key="excludeList"]')?.value||"",s=n('input[data-key="match"]')?.value||"",i=n('input[data-key="replace"]')?.value||"",c=e.querySelector(".link-template-select")?.value||"",d=!!e.querySelector(".disable-links")?.checked,u=!!e.querySelector(".require-vhost")?.checked,p=[];e.querySelectorAll(".special-case").forEach(e=>{const t=e.querySelector(".sc-match")?.value||"",n=e.querySelector(".sc-replace")?.value||"";(t.length||n.length)&&p.push({match:t,replace:n})});const m=function(e){const t={};return e.forEach(({match:e="",replace:n=""})=>{const o=String(e).trim(),a=String(n).trim();(o.length||a.length)&&(t[o]=a)}),t}(p),h=l.split(",").map(e=>e.trim()).filter(Boolean),g={title:o,href:a,dir:r,excludeList:h,urlRules:{match:s,replace:i},linkTemplate:c,disableLinks:d,requireVhost:u,specialCases:m};(o||a||r||h.length||s||i||c||d||u||Object.keys(m).length)&&t.push(g)}),t}(),null,2),l=!1)}e.addEventListener("input",e=>{e.target.matches('input[type="text"], select')&&u()}),e.addEventListener("change",e=>{e.target.matches('select, input[type="checkbox"]')&&u()}),e.addEventListener("click",e=>{if(e.target.closest(".add-special")){const t=e.target.closest(".folder-config-item")?.querySelector(".special-cases");t&&(t.insertAdjacentHTML("beforeend",i()),u())}if(e.target.closest(".remove-special")){const t=e.target.closest(".special-case");t&&(t.remove(),u())}if(e.target.closest(".remove-folder-column")){const t=e.target.closest(".folder-config-item");t&&(t.remove(),u())}}),e.addEventListener("sorted",()=>{l=!0,p()}),Promise.all([fetch(`${window.BASE_URL}utils/read_config.php?file=folders`,{cache:"no-store"}).then(e=>e.json()).catch(()=>[]),Array.isArray(window.LINK_TEMPLATES)?(a=window.LINK_TEMPLATES.map(e=>e&&"string"==typeof e.name?e.name.trim():"").filter(Boolean),a=Array.from(new Set(a)),r='<option value="">(none)</option>'+a.map(e=>`<option value="${e}">${e}</option>`).join(""),Promise.resolve(a)):fetch(`${window.BASE_URL}utils/read_config.php?file=link_templates`,{cache:"no-store"}).then(e=>e.json()).then(e=>(a=(Array.isArray(e)?e:[]).map(e=>e&&"string"==typeof e.name?e.name.trim():"").filter(Boolean),a=Array.from(new Set(a)),r='<option value="">(none)</option>'+a.map(e=>`<option value="${e}">${e}</option>`).join(""),a)).catch(()=>(a=[],r='<option value="">(none)</option>',a))]).then(([t])=>{n("#folders-config-list"),Array.isArray(t)&&t.length&&function(t){const n=document.createDocumentFragment(),o=document.createElement("div");o.innerHTML=t.map(c).join(""),Array.from(o.children).forEach(e=>n.appendChild(e)),e.appendChild(n),e.querySelectorAll(".folder-config-item").forEach(e=>{const n=e.querySelector(".link-template-select");if(n){const o=e.querySelector('input[data-key="title"]')?.value||"",r=t.find(e=>(e.title||"")===o),l=r?.linkTemplate||"";l&&(n.value=l),n.disabled=0===a.length}})}(t),0===e.children.length&&d({}),l=!0,p()}),t.addEventListener("click",()=>{d({})})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("link-templates-list"),t=document.getElementById("add-link-template"),n="HTML Template";function o(){const t=[];e.querySelectorAll(".template-item").forEach(e=>{const n=e.querySelector(".template-name")?.value.trim();let o="";o=e.querySelector(".template-html")?.textContent||"",o=o.replace(/\u200B/g,""),n&&o&&t.push({name:n,html:o})});const n=document.getElementById("link_templates_json_input");n&&(n.value=JSON.stringify(t,null,2))}function a(t={}){const a=document.createElement("li");a.className="template-item";let r="";r=`\n\t\t\t\t\t<div class="template-html-wrapper">\n\t\t\t\t\t\t<pre class="template-html syntax-highlight"\n\t\t\t\t\t\t\trole="textbox" aria-multiline="true" aria-label="HTML Template"\n\t\t\t\t\t\t\tplaceholder="${n}"></pre>\n\t\t\t\t\t</div>`,a.innerHTML=`\n\t\t\t\t<input type="text" class="template-name" placeholder="Template Name" value="${t.name||""}">\n\t\t\t\t${r}\n\t\t\t\t<button type="button" class="remove-template">‚ùå</button>\n\t\t\t`;let l=null;{const e=a.querySelector(".template-html");e.textContent=t.html||"",l=c(e,{placeholder:n,onChange:o})}a.querySelector(".remove-template").addEventListener("click",()=>{l&&"function"==typeof l.destroy&&l.destroy(),a.remove(),o()}),a.querySelector(".template-name").addEventListener("input",o),e.appendChild(a),o()}e&&t&&(t.addEventListener("click",()=>a()),e.innerHTML="",fetch(`${window.BASE_URL}utils/read_config.php?file=link_templates`,{cache:"no-store"}).then(e=>e.json()).then(e=>{(Array.isArray(e)?e:Array.isArray(e?.templates)?e.templates:[]).forEach(a),o()}).catch(()=>o()))}),s({sectionId:"apache-error-log-section",toggleButtonId:"toggle-apache-error-log",logElementId:"apache-error-log",endpoint:"utils/apache_error_log.php"}),s({sectionId:"php-error-log-section",toggleButtonId:"toggle-php-error-log",logElementId:"php-error-log",endpoint:"utils/php_error_log.php"}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>i()):i(),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".search-bar");e&&e.addEventListener("input",d)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("clear-local-storage");e&&e.addEventListener("click",()=>{confirm("Are you sure you want to reset saved UI settings?")&&(Object.keys(localStorage).filter(e=>u.some(t=>e.startsWith(t))).forEach(e=>localStorage.removeItem(e)),alert("Saved settings have been cleared from local storage."),location.reload())})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".post-confirmation-container");e&&setTimeout(()=>{e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout(()=>e.remove(),500)},3e3)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.body;if(!document.getElementById("system-monitor"))return;if("true"!==e.getAttribute("data-ajax-stats-enabled"))return;const t=document.getElementById("cpu-load"),n=document.getElementById("memory-usage"),o=document.getElementById("disk-space");let a;function r(){fetch(`${window.BASE_URL}utils/system_stats.php`,{cache:"no-store"}).then(e=>{if(!e.ok)throw new Error("System stats unavailable");return e.json()}).then(e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`})}fetch(`${window.BASE_URL}utils/system_stats.php`,{cache:"no-store"}).then(e=>{if(e.ok)return e.json()}).then(e=>{t.textContent=`${e.cpu}%`,n.textContent=`${e.memory} MB`,o.textContent=`${e.disk}%`,a=setInterval(r,1e3),r()}).catch(()=>{})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#theme-selector");if(!e)return;const t=localStorage.getItem("theme")||("undefined"!=typeof serverTheme?serverTheme:"default");p(t),e.value=t,e.addEventListener("change",e=>{const t=e.target.value;p(t),localStorage.setItem("theme",t)})}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{m(),h(),g()}):(m(),h(),g()),function(){function e(e){e.offsetHeight}function t(e){const t=getComputedStyle(e),n=e=>e.split(",").map(e=>parseFloat(e)||0),o=Math.max(...n(t.transitionDuration)),a=Math.max(...n(t.transitionDelay));return Math.round(1e3*(o+a))||0}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".toggle-content-container").forEach((n,o)=>{if("1"===n.dataset.accordionInit)return;n.dataset.accordionInit="1";const a=n.querySelector(".toggle-accordion"),r=n.querySelector(".toggle-content");if(!a||!r)return;const l=parseInt(r.dataset.collapsedHeight)||0,s=n.dataset.id||"accordion-"+o;let i=0,c=0,d=null;function u(){d&&(r.removeEventListener("transitionend",d),d=null),c&&(clearTimeout(c),c=0)}function p(e){n.classList.toggle("open",e),a.setAttribute("aria-expanded",e?"true":"false"),localStorage.setItem("accordion_"+s,e?"open":"closed")}function m(e){e===i&&(r.style.height="auto")}function h(e){e===i&&(r.hidden=!0)}function g(){const o=!n.classList.contains("open");o&&r.hidden&&(r.hidden=!1),o?function(){const n=++i;u(),r.hidden=!1,p(!0),r.style.height=l+"px",e(r),requestAnimationFrame(()=>{if(n!==i)return;const e=r.scrollHeight;r.style.height=e+"px",d=e=>{e.target===r&&"height"===e.propertyName&&(u(),m(n))},r.addEventListener("transitionend",d);const o=t(r);o>0&&(c=setTimeout(()=>{u(),m(n)},o+40))})}():function(){const n=++i;u(),p(!1),r.style.height=r.scrollHeight+"px",e(r),requestAnimationFrame(()=>{if(n!==i)return;r.style.height=l+"px",d=e=>{e.target===r&&"height"===e.propertyName&&(u(),h(n))},r.addEventListener("transitionend",d);const e=t(r);e>0&&(c=setTimeout(()=>{u(),h(n)},e+40))})}(),requestAnimationFrame(()=>{n.classList.contains("open")&&r.hidden&&(r.hidden=!1)})}const f="open"===localStorage.getItem("accordion_"+s);p(f),f?(r.hidden=!1,r.style.height=r.scrollHeight+"px",requestAnimationFrame(()=>{r.style.height="auto"})):(r.style.height=l+"px",r.hidden=!0),a.addEventListener("click",e=>{var t;(e.stopPropagation(),t=".tooltip-icon",e.target.closest(t))||g()}),a.addEventListener("keydown",e=>{if(" "===e.key||"Enter"===e.key)e.preventDefault(),g();else if("ArrowDown"===e.key&&n.classList.contains("open")&&!r.hidden){const e=r.querySelector('a,button,input,select,textarea,[tabindex]:not([tabindex="-1"])');e&&e.focus()}})}),window.addEventListener("resize",()=>{document.querySelectorAll(".toggle-content-container.open .toggle-content").forEach(e=>{e.hidden&&(e.hidden=!1),"auto"!==e.style.height&&(e.style.height=e.scrollHeight+"px")})})})}(),document.addEventListener("DOMContentLoaded",()=>{const e={index:document.getElementById("folders-view"),settings:document.getElementById("settings-view"),phpinfo:document.getElementById("phpinfo-view"),apache:document.getElementById("apache-view"),mysql:document.getElementById("mysql-view")},t={index:"index",settings:"settings",phpinfo:"phpinfo","apache-inspector":"apache","mysql-inspector":"mysql"};function n(){return new URLSearchParams(window.location.search).get("view")||"index"}function o(n,o=!1){const a=t[n]||"index";if(Object.entries(e).forEach(([e,t])=>{t&&t.classList.toggle("visible",e===a)}),function(e){const t=document.getElementById("page-title-prefix");if(!t)return;const n=t.dataset.prefix||"",o={index:"Modern Localhost and Remote Dashboard for Apache, MySQL & PHP",settings:"Settings",phpinfo:"PHP Info","apache-inspector":"Apache Inspector","mysql-inspector":"MySQL Inspector"},a=o[e]||o.index;document.title=n+a}(n),"apache"===a||"mysql"===a){const t=e[a];if(t&&!t.dataset.loaded){t.innerHTML='<div class="loader"><span class="spinner" role="img" aria-label="Loading"></span></div>';const e=`utils/${a}_inspector.php`;fetch(`${window.BASE_URL||"/"}${e}`).then(e=>e.text()).then(e=>{t.innerHTML=e,t.dataset.loaded="true"}).catch(n=>{t.innerHTML=`<p class="error">Failed to load ${e}</p>`,console.error(`[view.js] Failed to fetch ${e}`,n)})}}if(o){const e=window.BASE_URL||window.location.pathname,t="index"===a?"":"?view="+encodeURIComponent(n);history.pushState({},"",e+t)}}Object.entries({"toggle-index":"index","toggle-settings":"settings","toggle-phpinfo":"phpinfo","toggle-apache-inspector":"apache-inspector","toggle-mysql-inspector":"mysql-inspector"}).forEach(([e,t])=>{const n=document.getElementById(e);n&&n.addEventListener("click",e=>{e.preventDefault(),o(t,!0)})}),o(n()),window.addEventListener("popstate",()=>{o(n())})})})();
//# sourceMappingURL=script.min.js.map